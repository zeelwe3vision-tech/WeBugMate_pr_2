<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DebugMate Chatbot</title>

    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial;
            background: #f1f5f9;
            padding: 20px;
        }

        .chat-box {
            max-width: 1100px;
            margin: auto;
            background: #ffffff;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(15, 23, 42, 0.08);
        }

        textarea, input, select {
            width: 100%;
            padding: 10px;
            margin-top: 8px;
            margin-bottom: 12px;
            border-radius: 6px;
            border: 1px solid #d1d5db;
            font-size: 14px;
        }

        button {
            padding: 10px 18px;
            background: #2563eb;
            color: #ffffff;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
        }

        button:hover {
            background: #1d4ed8;
        }

        .response-box {
            margin-top: 20px;
        }

        .ai-ui-table {
            width: 100%;
            border-collapse: collapse;
        }

        .ai-ui-table th,
        .ai-ui-table td {
            padding: 12px 14px;
            border-bottom: 1px solid #e5e7eb;
            font-size: 13px;
            text-align: left;
        }

        .ai-ui-table th {
            background: #f8fafc;
            font-weight: 600;
        }

        .table-responsive {
            overflow-x: auto;
        }
    </style>
</head>

<body>

<div class="chat-box">
    <h2>ðŸ§  DebugMate â€“ Table Aware Chatbot</h2>

    <form method="post">
        <label>Message</label>
        <textarea name="message" rows="4">{{ user_input }}</textarea>

        <label>Project ID</label>
        <input type="text" name="project_id" value="{{ project_id }}">

        <label>Mode</label>
        <select name="mode">
            <option value="dual" {% if request.values.get("mode","dual") == "dual" %}selected{% endif %}>
                Dual
            </option>
            <option value="common" {% if request.values.get("mode") == "common" %}selected{% endif %}>
                Common
            </option>
        </select>

        <button type="submit">Ask</button>
    </form>

    {% if reply %}
    <div class="response-box">
        <h3>AI Response</h3>

        <!-- EXACT SAME TABLE / RESPONSE RENDER -->
        {{ table_html | safe }}

        {% if not is_tabular %}
            <pre style="white-space:pre-wrap;font-size:13px;margin-top:10px;">
{{ reply }}
            </pre>
        {% endif %}
    </div>
    {% endif %}
</div>

</body>
</html>
